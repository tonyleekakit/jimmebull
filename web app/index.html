<!doctype html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>訓練調控</title>
    <link rel="icon" type="image/png" href="./assets/logo.png" />
    <link rel="apple-touch-icon" href="./assets/logo.png" />
    <link rel="stylesheet" href="./styles.css?v=2.7" />
    <link rel="canonical" href="https://trainingmon.com/" />
  </head>
  <body>
    <header class="topbar">
      <nav class="tabs" aria-label="主要">
        <button class="tab is-active" type="button" data-tab="plan">訓練調控</button>
        <a href="./pace-calculator.html" class="tab">配速計算機</a>
        <button class="tab" type="button" data-tab="blog">部落格</button>
      </nav>
      <a class="brand" href="#plan" aria-label="返回訓練調控">
        <img class="brand__img" src="./assets/logo.png" alt="Logo" onerror="this.style.display='none';" />
      </a>
      <button id="authBtn" class="btn btn--primary authBtn" type="button">登入</button>
    </header>

    <main class="page">
      <section id="tab-plan" class="tabPanel is-active" aria-label="訓練調控">
        <div class="planActions">
          <div class="planActions__right">
            <button id="startWizardBtn" class="btn btn--primary" type="button">開始跑步計劃</button>
            <label class="annualVolumeField" aria-label="年總訓練量">
              <span class="muted">年總訓練量（小時）</span>
              <input
                id="annualVolumeInput"
                class="input"
                type="number"
                inputmode="decimal"
                step="1"
                min="0"
                placeholder="例如 320"
                aria-label="年總訓練量（小時）"
              />
            </label>
            <button id="annualVolumeApplyBtn" class="btn" type="button">套用</button>
            <button id="raceInputBtn" class="btn btn--primary" type="button">輸入比賽</button>
            <button id="resetBtn" class="btn btn--reset" type="button">重設</button>
          </div>
        </div>

        <div id="plannedVolume52" class="calendarSummary" aria-label="52 週計劃訓練量"></div>

        <div id="calendarShell" class="calendarShell" aria-label="訓練表">
          <div class="calendarSizer" aria-label="表格大小">
            <button id="calSizeUp" class="iconBtn" type="button" aria-label="放大" title="放大">+</button>
            <input id="calSizeRange" class="calSizeRange" type="range" min="70" max="140" step="5" value="100" aria-label="表格大小" />
            <button id="calSizeDown" class="iconBtn" type="button" aria-label="縮小" title="縮小">−</button>
          </div>
          <div class="calendarWrap">
            <div id="calendar" class="calendar" role="grid" aria-label="52 週訓練表"></div>
          </div>
        </div>

        <section class="weekSection" aria-label="每週詳情">
          <div class="weekHeader">
            <div class="weekPicker">
              <span class="muted">選擇週</span>
              <select id="weekSelect" aria-label="選擇週"></select>
              <button id="resetWeekBtn" class="btn btn--reset" type="button" style="margin-left: 8px;">重設本週課表</button>
              <button id="reset52WeeksBtn" class="btn btn--reset" type="button">重設52週課表</button>
            </div>
            <div id="weekMeta" class="muted"></div>
          </div>
          <div id="weekDays" class="weekDays" aria-label="Day 卡片"></div>
        </section>

        <div id="chartsRoot" class="chartsGrid" aria-label="圖表內容"></div>
      </section>



      <!-- 配速計算機 Tab Content Moved to pace-calculator.html -->

      <section id="tab-blog" class="tabPanel" aria-label="部落格">
        <div class="calendarSummary" aria-label="部落格說明">
          <div class="howtoIntro__title">部落格</div>
          <div class="muted">跑步訓練、恢復、風險管理等文章</div>
        </div>
        <div class="blogGrid" aria-label="部落格內容">
          <div class="chartCard" aria-label="文章列表">
            <div class="chartCard__title">文章列表</div>
            <div class="blogSearch" style="margin-bottom: 12px;">
              <input id="blogSearchInput" class="input" type="text" placeholder="輸入關鍵字搜尋標題或內容" aria-label="搜尋文章">
            </div>
            <div id="blogList" class="blogList"></div>
          </div>
          <div class="chartCard" aria-label="文章內容">
            <div id="blogTitle" class="chartCard__title"></div>
            <div id="blogMeta" class="muted"></div>
            <div id="blogArticle"></div>
          </div>
        </div>
      </section>
    </main>

    <script>
      (function() {
        try {
          var h = window.location.hash.replace(/^#/, '').trim();
          if (h) {
            var tabs = document.querySelectorAll('.tab[data-tab]');
            var panels = document.querySelectorAll('.tabPanel');
            var match = false;
            
            for (var i = 0; i < panels.length; i++) {
              if (panels[i].id === 'tab-' + h) {
                match = true;
                break;
              }
            }

            if (match) {
              for (var i = 0; i < tabs.length; i++) {
                var t = tabs[i];
                if (t.getAttribute('data-tab') === h) t.classList.add('is-active');
                else t.classList.remove('is-active');
              }
              for (var i = 0; i < panels.length; i++) {
                var p = panels[i];
                if (p.id === 'tab-' + h) p.classList.add('is-active');
                else p.classList.remove('is-active');
              }
            }
          }
        } catch(e) {}
      })();
    </script>

    <script>
      globalThis.__SUPABASE__ = {
        url: "https://yonmaiyxjewsdnyvkzvm.supabase.co",
        anonKey: "sb_publishable_JjjPDuMbjhS6NsOiNWn9YQ_5VrjOFqN",
      };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="./app.js?v=20"></script>
  </body>
</html>
